<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube åŸ‹ã‚è¾¼ã¿å†ç”Ÿæ¤œè¨¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            padding: 2rem;
            background: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            margin-bottom: 1rem;
            color: #333;
        }
        .section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: #fafafa;
            border-radius: 6px;
            border-left: 4px solid #ff0000;
        }
        .section h2 {
            margin-bottom: 1rem;
            color: #ff0000;
        }
        .input-group {
            margin: 1rem 0;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #555;
        }
        input[type="text"] {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-family: 'Monaco', 'Courier New', monospace;
        }
        button {
            padding: 0.75rem 1.5rem;
            background: #ff0000;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 0.5rem;
        }
        button:hover {
            background: #cc0000;
        }
        .media-container {
            margin: 1.5rem 0;
            padding: 1rem;
            background: white;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 */
            height: 0;
            overflow: hidden;
            max-width: 100%;
            background: #000;
            border-radius: 4px;
        }
        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .info {
            margin: 1rem 0;
            padding: 1rem;
            background: #e3f2fd;
            border-radius: 4px;
            font-size: 14px;
        }
        .info.success {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
        }
        .info.error {
            background: #ffebee;
            border-left: 4px solid #f44336;
        }
        .info.warning {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
        }
        .url-converter {
            margin: 1rem 0;
            padding: 1rem;
            background: #fff3e0;
            border-radius: 4px;
            font-size: 13px;
        }
        .url-converter code {
            display: block;
            margin: 0.5rem 0;
            padding: 0.5rem;
            background: white;
            border-radius: 3px;
            word-break: break-all;
        }
        .embed-code {
            margin: 1rem 0;
            padding: 1rem;
            background: #f5f5f5;
            border-radius: 4px;
            font-size: 12px;
        }
        .embed-code pre {
            margin: 0;
            padding: 0.5rem;
            background: white;
            border-radius: 3px;
            overflow-x: auto;
        }
        .test-results {
            margin-top: 2rem;
        }
        .test-item {
            margin: 1rem 0;
            padding: 1rem;
            background: white;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        .test-item h3 {
            margin-bottom: 0.5rem;
            color: #333;
        }
        .status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        .status.success {
            background: #4caf50;
            color: white;
        }
        .status.error {
            background: #f44336;
            color: white;
        }
        .status.pending {
            background: #ff9800;
            color: white;
        }
        .method-tabs {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
        }
        .tab {
            padding: 0.5rem 1rem;
            background: #e0e0e0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .tab.active {
            background: #ff0000;
            color: white;
        }
        .method-content {
            display: none;
        }
        .method-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”¬ YouTube åŸ‹ã‚è¾¼ã¿å†ç”Ÿæ¤œè¨¼</h1>
        
        <div class="section">
            <h2>ğŸ“ ä½¿ã„æ–¹</h2>
            <ol style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>YouTubeã®å‹•ç”»URLã‚’å–å¾—ï¼ˆæ§˜ã€…ãªå½¢å¼ã«å¯¾å¿œï¼‰</li>
                <li>ä¸‹ã®å…¥åŠ›æ¬„ã«è²¼ã‚Šä»˜ã‘</li>
                <li>ã€Œå¤‰æ›ã—ã¦ãƒ†ã‚¹ãƒˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>åŸ‹ã‚è¾¼ã¿æ–¹æ³•ã‚’é¸æŠã—ã¦å†ç”Ÿã‚’ç¢ºèª</li>
            </ol>
            <div class="info warning" style="margin-top: 1rem;">
                <strong>âš ï¸ æ³¨æ„:</strong> YouTubeã®åŸ‹ã‚è¾¼ã¿ã«ã¯ã€å‹•ç”»ã®åŸ‹ã‚è¾¼ã¿è¨­å®šãŒæœ‰åŠ¹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¸€éƒ¨ã®å‹•ç”»ã¯åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br><br>
                <strong>åŸ‹ã‚è¾¼ã¿è¨­å®šã®ç¢ºèªæ–¹æ³•:</strong><br>
                1. YouTube Studioã«ã‚¢ã‚¯ã‚»ã‚¹<br>
                2. å‹•ç”»ã‚’é¸æŠ â†’ ã€Œè©³ç´°ã€ã‚¿ãƒ–<br>
                3. ã€Œé…ä¿¡ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¨­å®šã€ã§ã€ŒåŸ‹ã‚è¾¼ã¿ã‚’è¨±å¯ã€ã‚’ç¢ºèª
            </div>
        </div>

        <div class="section">
            <h2>ğŸ¬ YouTubeå‹•ç”»åŸ‹ã‚è¾¼ã¿ãƒ†ã‚¹ãƒˆ</h2>
            <div class="input-group">
                <label for="youtubeUrl">YouTubeå‹•ç”»URLï¼ˆä»»æ„ã®å½¢å¼ï¼‰:</label>
                <input type="text" id="youtubeUrl" placeholder="https://www.youtube.com/watch?v=xxxxx ã¾ãŸã¯ https://youtu.be/xxxxx">
                <button onclick="testYouTube()">å¤‰æ›ã—ã¦ãƒ†ã‚¹ãƒˆ</button>
            </div>
            
            <div id="youtubeResult" class="media-container" style="display: none;">
                <div class="url-converter">
                    <strong>æŠ½å‡ºã•ã‚ŒãŸå‹•ç”»ID:</strong>
                    <code id="videoId"></code>
                </div>
                
                <div class="method-tabs">
                    <button class="tab active" onclick="switchMethod('iframe')">iframeåŸ‹ã‚è¾¼ã¿ï¼ˆæ¨å¥¨ï¼‰</button>
                    <button class="tab" onclick="switchMethod('api')">YouTube Player API</button>
                    <button class="tab" onclick="switchMethod('direct')">ç›´æ¥URLï¼ˆå‚è€ƒï¼‰</button>
                </div>

                <!-- iframeåŸ‹ã‚è¾¼ã¿ -->
                <div id="method-iframe" class="method-content active">
                    <div class="info success">
                        âœ… <strong>iframeåŸ‹ã‚è¾¼ã¿ï¼ˆæ¨å¥¨ï¼‰</strong><br>
                        æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ç¢ºå®Ÿãªæ–¹æ³•ã€‚YouTubeãŒæä¾›ã™ã‚‹æ¨™æº–çš„ãªåŸ‹ã‚è¾¼ã¿æ–¹æ³•ã§ã™ã€‚<br>
                        <strong>ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰153ãŒç™ºç”Ÿã™ã‚‹å ´åˆ:</strong> iframeåŸ‹ã‚è¾¼ã¿ã¯APIã«ä¾å­˜ã—ãªã„ãŸã‚ã€ã‚ˆã‚Šå®‰å®šã—ã¦å‹•ä½œã—ã¾ã™ã€‚
                    </div>
                    <div class="embed-code">
                        <strong>åŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰:</strong>
                        <pre id="iframeCode"></pre>
                    </div>
                    <div id="iframeStatus" class="info" style="display: none; margin-top: 1rem;"></div>
                    <div class="video-wrapper" id="iframeContainer"></div>
                    <div id="iframeFallback" style="display: none; margin-top: 1rem;">
                        <div class="info error">
                            <strong>âŒ åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ã§ã™</strong><br>
                            ã“ã®å‹•ç”»ã¯åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€ç›´æ¥YouTubeã§è¦–è´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
                        </div>
                        <div style="margin-top: 1rem;">
                            <a id="youtubeLink" href="#" target="_blank" style="display: inline-block; padding: 0.75rem 1.5rem; background: #ff0000; color: white; text-decoration: none; border-radius: 4px;">
                                â–¶ YouTubeã§è¦–è´
                            </a>
                        </div>
                        <div style="margin-top: 1rem;">
                            <strong>ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒ:</strong><br>
                            <img id="thumbnailPreview" src="" alt="ã‚µãƒ ãƒã‚¤ãƒ«" style="max-width: 100%; border-radius: 4px; margin-top: 0.5rem;">
                        </div>
                    </div>
                </div>

                <!-- YouTube Player API -->
                <div id="method-api" class="method-content">
                    <div class="info">
                        â„¹ï¸ <strong>YouTube Player API</strong><br>
                        ã‚ˆã‚Šé«˜åº¦ãªåˆ¶å¾¡ãŒå¯èƒ½ã€‚å†ç”Ÿã€ä¸€æ™‚åœæ­¢ã€ã‚·ãƒ¼ã‚¯ãªã©ã®æ“ä½œãŒã§ãã¾ã™ã€‚
                    </div>
                    <div class="embed-code">
                        <strong>å®Ÿè£…ä¾‹:</strong>
                        <pre id="apiCode"></pre>
                    </div>
                    <div class="video-wrapper" id="apiContainer"></div>
                </div>

                <!-- ç›´æ¥URLï¼ˆå‚è€ƒï¼‰ -->
                <div id="method-direct" class="method-content">
                    <div class="info warning">
                        âš ï¸ <strong>ç›´æ¥URLï¼ˆå‚è€ƒï¼‰</strong><br>
                        é€šå¸¸ã¯iframeãŒå¿…è¦ã§ã™ã€‚ç›´æ¥URLã§ã®å†ç”Ÿã¯åˆ¶é™ãŒã‚ã‚Šã¾ã™ã€‚
                    </div>
                    <div class="embed-code">
                        <strong>ç›´æ¥URLï¼ˆé€šå¸¸ã¯å‹•ä½œã—ã¾ã›ã‚“ï¼‰:</strong>
                        <pre id="directUrl"></pre>
                    </div>
                    <div style="margin-top: 1rem;">
                        <strong>åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ãªå ´åˆã®ä»£æ›¿è¡¨ç¤º:</strong>
                        <pre style="margin-top: 0.5rem; padding: 1rem; background: #f5f5f5; border-radius: 4px; font-size: 12px;">&lt;!-- ã‚µãƒ ãƒã‚¤ãƒ« + ãƒªãƒ³ã‚¯è¡¨ç¤º --&gt;
&lt;a href="https://www.youtube.com/watch?v=${currentVideoId || 'VIDEO_ID'}" target="_blank"&gt;
  &lt;img src="https://img.youtube.com/vi/${currentVideoId || 'VIDEO_ID'}/maxresdefault.jpg" alt="å‹•ç”»ã‚µãƒ ãƒã‚¤ãƒ«"&gt;
  &lt;div&gt;â–¶ YouTubeã§è¦–è´&lt;/div&gt;
&lt;/a&gt;</pre>
                    </div>
                </div>

                <div id="youtubeInfo" class="info" style="margin-top: 1rem;"></div>
            </div>
        </div>

        <div class="section test-results">
            <h2>ğŸ“Š æ¤œè¨¼çµæœã‚µãƒãƒªãƒ¼</h2>
            <div id="testSummary"></div>
        </div>
    </div>

    <!-- YouTube Player API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        let ytPlayer = null;
        let currentVideoId = null;

        // YouTube URLã‹ã‚‰å‹•ç”»IDã‚’æŠ½å‡º
        function extractVideoId(url) {
            if (!url) return null;

            // æ§˜ã€…ãªYouTube URLå½¢å¼ã«å¯¾å¿œ
            const patterns = [
                /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,
                /youtube\.com\/watch\?.*v=([^&\n?#]+)/
            ];

            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match && match[1]) {
                    return match[1];
                }
            }

            return null;
        }

        // ãƒ¡ã‚½ãƒƒãƒ‰åˆ‡ã‚Šæ›¿ãˆ
        function switchMethod(method) {
            // ã‚¿ãƒ–ã®åˆ‡ã‚Šæ›¿ãˆ
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.method-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`method-${method}`).classList.add('active');

            // å‹•ç”»IDãŒã‚ã‚‹å ´åˆã¯å†æç”»
            if (currentVideoId) {
                if (method === 'iframe') {
                    renderIframe(currentVideoId);
                } else if (method === 'api') {
                    renderAPI(currentVideoId);
                }
            }
        }

        // iframeåŸ‹ã‚è¾¼ã¿
        function renderIframe(videoId) {
            const embedUrl = `https://www.youtube.com/embed/${videoId}?rel=0`;
            const iframeCode = `<iframe width="560" height="315" src="${embedUrl}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
            
            document.getElementById('iframeCode').textContent = iframeCode;
            
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('iframeStatus').style.display = 'none';
            document.getElementById('iframeFallback').style.display = 'none';
            
            // iframeã‚’ä½œæˆ
            const container = document.getElementById('iframeContainer');
            container.innerHTML = iframeCode;
            
            // iframeã®ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã‚’è©¦ã¿ã‚‹
            const iframe = container.querySelector('iframe');
            if (iframe) {
                // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§åŸ‹ã‚è¾¼ã¿çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
                setTimeout(() => {
                    checkIframeEmbedStatus(videoId);
                }, 2000);
                
                // iframeã®loadã‚¤ãƒ™ãƒ³ãƒˆ
                iframe.onload = () => {
                    // ãƒ­ãƒ¼ãƒ‰å®Œäº†å¾Œã€å°‘ã—å¾…ã£ã¦ã‹ã‚‰ãƒã‚§ãƒƒã‚¯
                    setTimeout(() => {
                        checkIframeEmbedStatus(videoId);
                    }, 1000);
                };
            }
        }
        
        // iframeã®åŸ‹ã‚è¾¼ã¿çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
        function checkIframeEmbedStatus(videoId) {
            // YouTubeã®åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ãªå ´åˆã€iframeå†…ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
            // å®Ÿéš›ã®æ¤œè¨¼ã¯é›£ã—ã„ãŸã‚ã€ä»£æ›¿æ‰‹æ®µã‚’æç¤º
            const statusDiv = document.getElementById('iframeStatus');
            statusDiv.style.display = 'block';
            statusDiv.className = 'info warning';
            statusDiv.innerHTML = `
                <strong>âš ï¸ åŸ‹ã‚è¾¼ã¿çŠ¶æ…‹ã®ç¢ºèª</strong><br>
                iframeãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚<br>
                ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã¯ã€åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
            `;
        }
        
        // åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ãªå ´åˆã®ä»£æ›¿è¡¨ç¤º
        function showIframeFallback(videoId) {
            const fallbackDiv = document.getElementById('iframeFallback');
            const youtubeLink = document.getElementById('youtubeLink');
            const thumbnailPreview = document.getElementById('thumbnailPreview');
            
            youtubeLink.href = `https://www.youtube.com/watch?v=${videoId}`;
            thumbnailPreview.src = `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`;
            thumbnailPreview.onerror = function() {
                this.src = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
            };
            
            fallbackDiv.style.display = 'block';
        }

        // YouTube Player API
        function renderAPI(videoId) {
            const container = document.getElementById('apiContainer');
            container.innerHTML = '<div id="youtube-player"></div>';
            
            const apiCode = `// YouTube Player APIä½¿ç”¨ä¾‹
const tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
const firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

let player;
function onYouTubeIframeAPIReady() {
  player = new YT.Player('youtube-player', {
    height: '315',
    width: '560',
    videoId: '${videoId}',
    playerVars: {
      'playsinline': 1
    },
    events: {
      'onReady': onPlayerReady
    }
  });
}

function onPlayerReady(event) {
  // å†ç”Ÿå¯èƒ½
}`;
            
            document.getElementById('apiCode').textContent = apiCode;

            // æ—¢å­˜ã®ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã‚’ç ´æ£„
            if (ytPlayer) {
                ytPlayer.destroy();
            }

            // æ–°ã—ã„ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã‚’ä½œæˆ
            if (typeof YT !== 'undefined' && YT.Player) {
                ytPlayer = new YT.Player('youtube-player', {
                    height: '315',
                    width: '100%',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1,
                        'rel': 0
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onError': onPlayerError
                    }
                });
            } else {
                // APIãŒã¾ã èª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„å ´åˆ
                document.getElementById('apiContainer').innerHTML = '<div class="info warning">YouTube Player APIã®èª­ã¿è¾¼ã¿ã‚’å¾…ã£ã¦ã„ã¾ã™...</div>';
            }
        }

        function onPlayerReady(event) {
            const infoDiv = document.getElementById('youtubeInfo');
            infoDiv.className = 'info success';
            infoDiv.innerHTML = 'âœ… YouTube Player API: ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã®æº–å‚™ãŒå®Œäº†ã—ã¾ã—ãŸã€‚å†ç”Ÿå¯èƒ½ã§ã™ã€‚';
            addTestResult('YouTube Player API', true, currentVideoId);
        }

        function onPlayerError(event) {
            const infoDiv = document.getElementById('youtubeInfo');
            const errorCode = event.data;
            let errorMessage = 'âŒ YouTube Player API: ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚';
            
            // ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã«å¿œã˜ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            let solutionMessage = '';
            switch(errorCode) {
                case 2:
                    errorMessage = 'âŒ ç„¡åŠ¹ãªå‹•ç”»IDã§ã™ã€‚';
                    solutionMessage = 'å‹•ç”»IDãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
                    break;
                case 5:
                    errorMessage = 'âŒ HTML5ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã®ã‚¨ãƒ©ãƒ¼ã§ã™ã€‚';
                    solutionMessage = 'ãƒ–ãƒ©ã‚¦ã‚¶ã®äº’æ›æ€§ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
                    break;
                case 100:
                    errorMessage = 'âŒ å‹•ç”»ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å‰Šé™¤ã•ã‚ŒãŸã‹ã€éå…¬é–‹ã«ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚';
                    solutionMessage = 'å‹•ç”»ãŒå­˜åœ¨ã™ã‚‹ã‹ã€å…¬é–‹è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
                    break;
                case 101:
                case 150:
                    errorMessage = 'âŒ å‹•ç”»ã®åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã¾ã™ã€‚ã“ã®å‹•ç”»ã¯åŸ‹ã‚è¾¼ã¿å†ç”Ÿã§ãã¾ã›ã‚“ã€‚';
                    solutionMessage = 'YouTube Studioã§å‹•ç”»ã®åŸ‹ã‚è¾¼ã¿è¨­å®šã‚’ç¢ºèªãƒ»æœ‰åŠ¹åŒ–ã—ã¦ãã ã•ã„ã€‚';
                    break;
                case 153:
                    errorMessage = 'âŒ ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰153: å‹•ç”»ã®å†ç”ŸãŒåˆ¶é™ã•ã‚Œã¦ã„ã¾ã™ã€‚';
                    solutionMessage = `
                        <strong>è€ƒãˆã‚‰ã‚Œã‚‹åŸå› :</strong><br>
                        1. åœ°åŸŸåˆ¶é™ï¼ˆç‰¹å®šã®åœ°åŸŸã§ã®ã¿è¦–è´å¯èƒ½ï¼‰<br>
                        2. å¹´é½¢åˆ¶é™ï¼ˆ18æ­³ä»¥ä¸Šã®ã¿è¦–è´å¯èƒ½ï¼‰<br>
                        3. è‘—ä½œæ¨©åˆ¶é™ï¼ˆä¸€éƒ¨ã®åœ°åŸŸã§åˆ¶é™ï¼‰<br>
                        4. YouTube Player APIã®èª­ã¿è¾¼ã¿ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®å•é¡Œ<br><br>
                        <strong>æ¨å¥¨ã•ã‚Œã‚‹å¯¾å‡¦æ³•:</strong><br>
                        âœ… <strong>iframeåŸ‹ã‚è¾¼ã¿ã‚’ä½¿ç”¨ã™ã‚‹</strong>ï¼ˆAPIã‚’ä½¿ã‚ãªã„æ–¹æ³•ï¼‰<br>
                        iframeåŸ‹ã‚è¾¼ã¿ã¯ã€APIã«ä¾å­˜ã—ãªã„ãŸã‚ã€ã‚ˆã‚Šå®‰å®šã—ã¦å‹•ä½œã—ã¾ã™ã€‚<br>
                        ä¸Šè¨˜ã®ã€ŒiframeåŸ‹ã‚è¾¼ã¿ï¼ˆæ¨å¥¨ï¼‰ã€ã‚¿ãƒ–ã§å‹•ä½œã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
                    `;
                    break;
                default:
                    errorMessage = `âŒ ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰: ${errorCode}ã€‚`;
                    solutionMessage = `
                        å‹•ç”»ã®åŸ‹ã‚è¾¼ã¿ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚<br>
                        YouTube Studioã§å‹•ç”»ã®åŸ‹ã‚è¾¼ã¿è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚<br><br>
                        <strong>æ¨å¥¨:</strong> iframeåŸ‹ã‚è¾¼ã¿ï¼ˆAPIã‚’ä½¿ã‚ãªã„æ–¹æ³•ï¼‰ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚
                    `;
            }
            
            infoDiv.className = 'info error';
            infoDiv.innerHTML = `
                ${errorMessage}<br><br>
                ${solutionMessage}
            `;
            addTestResult('YouTube Player API', false, currentVideoId, `ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰: ${errorCode}`);
            
            // ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰153ã®å ´åˆã¯ã€iframeåŸ‹ã‚è¾¼ã¿ã‚’æ¨å¥¨
            if (errorCode === 153) {
                const iframeInfo = document.getElementById('iframeStatus');
                if (iframeInfo) {
                    iframeInfo.style.display = 'block';
                    iframeInfo.className = 'info success';
                    iframeInfo.innerHTML = `
                        <strong>ğŸ’¡ è§£æ±ºç­–:</strong> ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰153ãŒç™ºç”Ÿã—ãŸå ´åˆã€YouTube Player APIã§ã¯ãªãã€<strong>iframeåŸ‹ã‚è¾¼ã¿</strong>ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚<br>
                        iframeåŸ‹ã‚è¾¼ã¿ã¯ã€APIã«ä¾å­˜ã—ãªã„ãŸã‚ã€ã‚ˆã‚Šå®‰å®šã—ã¦å‹•ä½œã—ã¾ã™ã€‚
                    `;
                }
            } else {
                // ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤º
                showIframeFallback(currentVideoId);
            }
        }

        // YouTubeãƒ†ã‚¹ãƒˆ
        function testYouTube() {
            const inputUrl = document.getElementById('youtubeUrl').value.trim();
            if (!inputUrl) {
                alert('URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            const videoId = extractVideoId(inputUrl);
            if (!videoId) {
                alert('æœ‰åŠ¹ãªYouTube URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            currentVideoId = videoId;
            const resultDiv = document.getElementById('youtubeResult');
            const videoIdDiv = document.getElementById('videoId');
            const infoDiv = document.getElementById('youtubeInfo');

            resultDiv.style.display = 'block';
            videoIdDiv.textContent = videoId;

            // iframeåŸ‹ã‚è¾¼ã¿ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¡¨ç¤º
            renderIframe(videoId);
            
            // ç›´æ¥URLã‚’è¡¨ç¤º
            document.getElementById('directUrl').textContent = `https://www.youtube.com/watch?v=${videoId}`;

            // APIåŸ‹ã‚è¾¼ã¿ã‚‚æº–å‚™
            renderAPI(videoId);

            infoDiv.className = 'info success';
            infoDiv.innerHTML = 'âœ… å‹•ç”»IDã®æŠ½å‡ºã«æˆåŠŸã—ã¾ã—ãŸã€‚åŸ‹ã‚è¾¼ã¿æ–¹æ³•ã‚’é¸æŠã—ã¦å†ç”Ÿã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
            addTestResult('YouTubeå‹•ç”»IDæŠ½å‡º', true, videoId);
        }

        // ãƒ†ã‚¹ãƒˆçµæœã‚’è¨˜éŒ²
        const testResults = [];
        function addTestResult(type, success, videoId, error = null) {
            testResults.push({
                type,
                success,
                videoId,
                error,
                timestamp: new Date().toLocaleTimeString()
            });
            updateTestSummary();
        }

        function updateTestSummary() {
            const summaryDiv = document.getElementById('testSummary');
            if (testResults.length === 0) {
                summaryDiv.innerHTML = '<p style="color: #999;">ã¾ã ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>';
                return;
            }

            let html = '';
            testResults.forEach((result, index) => {
                const statusClass = result.success ? 'success' : 'error';
                const statusText = result.success ? 'âœ… æˆåŠŸ' : 'âŒ å¤±æ•—';
                html += `
                    <div class="test-item">
                        <h3>
                            ${result.type} 
                            <span class="status ${statusClass}">${statusText}</span>
                            <span style="font-size: 12px; color: #999; font-weight: normal;">(${result.timestamp})</span>
                        </h3>
                        <p style="font-size: 12px; color: #666; margin-top: 0.5rem;">
                            å‹•ç”»ID: ${result.videoId}
                        </p>
                        ${result.error ? `<p style="color: #f44336; font-size: 12px; margin-top: 0.5rem;">ã‚¨ãƒ©ãƒ¼: ${result.error}</p>` : ''}
                    </div>
                `;
            });
            summaryDiv.innerHTML = html;
        }

        // Enterã‚­ãƒ¼ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        document.getElementById('youtubeUrl').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') testYouTube();
        });

        // YouTube Player APIã®æº–å‚™å®Œäº†ã‚’å¾…ã¤
        function onYouTubeIframeAPIReady() {
            if (currentVideoId && document.getElementById('method-api').classList.contains('active')) {
                renderAPI(currentVideoId);
            }
        }
    </script>
</body>
</html>
